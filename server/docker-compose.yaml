version: '3.9'

services:
  nginx:
    image: nginx:1.25-alpine
    container_name: nginx
    ports:
      - "${NGINX_PORT}:80"
    volumes:
      - ${NGINX_CONF}:/etc/nginx/conf.d/default.conf:ro
    depends_on:
      - lcjs-server1
      - lcjs-server2
      - lcjs-server3

  lcjs-server1:
    image: lcjs-server:latest
    container_name: lcjs-server1
    environment:
      - NODE_ENV=${NODE_ENV}
      - PORT=3001

  lcjs-server2:
    image: lcjs-server:latest
    container_name: lcjs-server2
    environment:
      - NODE_ENV=${NODE_ENV}
      - PORT=3002

  lcjs-server3:
    image: lcjs-server:latest
    container_name: lcjs-server3
    environment:
      - NODE_ENV=${NODE_ENV}
      - PORT=3003
